# üöÄ OTUS Server Automation Setup

[![2025-06-01-11-46-35.jpg](https://i.postimg.cc/9MrsBJ4y/2025-06-01-11-46-35.jpg)](https://postimg.cc/LYFy9k3s)

![Linux](https://img.shields.io/badge/-Linux-grey?logo=linux)
![Bash](https://img.shields.io/badge/Bash-v4.4%5E-green?logo=GNU%20bash)
[![](https://jaywcjlove.github.io/sb/ico/mysql.svg)](http://www.mysql.com/)
[![Elastic Stack version](https://img.shields.io/badge/Elastic%20Stack-9.0.1-00bfb3?style=flat&logo=elastic-stack)](https://www.elastic.co/blog/category/releases)
[![Grafana](https://img.shields.io/badge/grafana-%23F46800.svg?&logo=grafana&logoColor=white)](https://grafana.com/)
[![Donate](https://img.shields.io/badge/-Donate-yellow?logo=paypal)](https://button.dekel.ru/)
[![Sponsor](https://img.shields.io/badge/-Sponsor-red?logo=github)](https://button.dekel.ru/)
[![Coffee](https://img.shields.io/badge/-Buy%20me%20a%20Coffee-grey?logo=Ko-fi)](https://button.dekel.ru/)

–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ä–≤–µ—Ä–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è –∫—É—Ä—Å–∞ OTUS.  
–°–∫—Ä–∏–ø—Ç—ã –≤—ã–ø–æ–ª–Ω—è—é—Ç –ø–æ–ª–Ω—É—é –ø–æ–¥–≥–æ—Ç–æ–≤–∫—É —Å—Ä–µ–¥—ã: –æ—Ç –±–∞–∑–æ–≤–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ç–∏ –¥–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ —Å–∏—Å—Ç–µ–º—ã –±—ç–∫–∞–ø–æ–≤.

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ
- [üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç](#-–±—ã—Å—Ç—Ä—ã–π-—Å—Ç–∞—Ä—Ç)
- [‚öôÔ∏è –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è](#Ô∏è-–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å-–≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è)
- [üìú –û–ø–∏—Å–∞–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–æ–≤](#-–æ–ø–∏—Å–∞–Ω–∏–µ-—Å–∫—Ä–∏–ø—Ç–æ–≤)
- [‚ùó–í–∞–∂–Ω—ã–µ –ø—Ä–∏–º–µ—á–∞–Ω–∏—è](#-–≤–∞–∂–Ω—ã–µ-–ø—Ä–∏–º–µ—á–∞–Ω–∏—è)
- [üîÑ –ê–≤–∞—Ä–∏–π–Ω–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ](#-–∞–≤–∞—Ä–∏–π–Ω–æ–µ-–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ)
- [üéâ –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏](#-–∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ-—É—Å—Ç–∞–Ω–æ–≤–∫–∏)

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```bash
# –ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –¥–æ–º–∞—à–Ω—é—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
cd /home/vboxuser || { echo "–û—à–∏–±–∫–∞: –Ω–µ —É–¥–∞–ª–æ—Å—å –ø–µ—Ä–µ–π—Ç–∏ –≤ /home/vboxuser"; exit 1; }

# –û—á–∏—â–∞–µ–º –∏ –∫–ª–æ–Ω–∏—Ä—É–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
LOCAL_WORK_DIR="/home/vboxuser/otus"
sudo rm -rf "$LOCAL_WORK_DIR"
git clone "https://github.com/otus20250412/otus.git"
cd otus

# –î–µ–ª–∞–µ–º —Å–∫—Ä–∏–ø—Ç—ã –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º–∏
chmod +x *.sh

# –ó–∞–ø—É—Å–∫–∞–µ–º –æ—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ—Ü–µ—Å—Å —É—Å—Ç–∞–Ω–æ–≤–∫–∏
./0_full_install.sh
```

## üìú –û–ø–∏—Å–∞–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–æ–≤

| # | –°–∫—Ä–∏–ø—Ç | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è |
| - | --------- | ---------------- | ---- |
| 1 | 1_setup_network_v2.sh | –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ç–µ–≤—ã—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤ –∏ –ø—Ä–∞–≤–∏–ª –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ | 2-5 –º–∏–Ω
| 2 | 2_install.sh | –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Nginx, Apache2, –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏ –Ω–∞–≥—Ä—É–∑–∫–∏ | 10-15 –º–∏–Ω
| 3 | 3_setup_iptables.sh | –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è firewall (iptables) –¥–ª—è –∑–∞—â–∏—Ç—ã —Å–µ—Ä–≤–µ—Ä–∞ | 1-2 –º–∏–Ω
| 4 | 4_install_mysql.sh | –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ MySQL/MariaDB, —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –ë–î | 5-10 –º–∏–Ω
| 5 | 5_install_monitoring.sh | –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ —Å—Ç–µ–∫–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ (Prometheus, Node Exporter, Grafana) | 5-7 –º–∏–Ω
| 6 | 6_install_elk_v3.sh | –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ ELK-—Å—Ç–µ–∫–∞ (Elasticsearch, Kibana, Filebeat) –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è | 10-15 –º–∏–Ω
| 7 | 7_backup_slave_and_push.sh | –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –±—ç–∫–∞–ø–æ–≤ –ë–î —Å –æ—Ç–ø—Ä–∞–≤–∫–æ–π –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π | 3-5 –º–∏–Ω
| 8 | 8_restore_db_master.sh | –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ë–î –∏–∑ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –±—ç–∫–∞–ø–∞ (–¥–ª—è –∞–≤–∞—Ä–∏–π–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤) | 5-10 –º–∏–Ω

## ‚ùó–í–∞–∂–Ω—ã–µ –ø—Ä–∏–º–µ—á–∞–Ω–∏—è

–í—Å–µ —Å–∫—Ä–∏–ø—Ç—ã –¥–æ–ª–∂–Ω—ã –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –∏–∑ –ø–∞–ø–∫–∏ /home/vboxuser

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Å–∏—Å—Ç–µ–º–µ:
* Ubuntu Server 20.04/22.04 LTS
* –ú–∏–Ω–∏–º—É–º 4GB RAM (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 8GB –¥–ª—è —Ä–∞–±–æ—Ç—ã ELK-—Å—Ç–µ–∫–∞)
* 20GB —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞ –Ω–∞ –¥–∏—Å–∫–µ
* –î–æ—Å—Ç—É–ø –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –ø–∞–∫–µ—Ç–æ–≤
* –õ–æ–≥–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ /var/log/otus_setup.log
* –î–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤ GitHub –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ personal access token

## –¢—Ä–µ–±—É–µ–º—ã–µ –¥–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤—ã –≤ –¥–æ–º–∞—à–Ω–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏:
* elasticsearch-8.9.1-amd64.deb
* filebeat-8.9.1-amd64.deb
* grafana_10.4.1_amd64.deb
* kibana-8.9.1-amd64.deb

## –î–æ—Å—Ç—É–ø–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏:

* –í–µ–±-—Å–µ—Ä–≤–µ—Ä: http://–≤–∞—à-—Å–µ—Ä–≤–µ—Ä
* Grafana (–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥): http://–≤–∞—à-—Å–µ—Ä–≤–µ—Ä:3000
* Kibana (–ª–æ–≥–∏): http://–≤–∞—à-—Å–µ—Ä–≤–µ—Ä:5601
* Prometheus (–º–µ—Ç—Ä–∏–∫–∏): http://–≤–∞—à-—Å–µ—Ä–≤–µ—Ä:9090

## üéâ –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏
* –°–º–µ–Ω–∏—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–∞—Ä–æ–ª–∏
* –ó–∞–ø—Ä–µ—Ç–∏—Ç—å –Ω–∞ SLAVE –ª–æ–≥–∏–Ω –ø–æ–¥ root
